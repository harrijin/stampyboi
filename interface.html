<html>

  <head>

  </head>

  <body>
    <button onclick="ytSearch()">Search YouTube video</button>
    <button onclick="flixSearch()">Search Netflix show</button>
    <button onclick="fileSearch()">Search a video/audio file</button>

    <br>
    <br>
    <form action="javascript:sendSearch()" id="searchForm">
      <label for="quote">Quote to search for:</label>
      <input type="text" id="quote" name="quote"/> 

      <p>in this video/audio file:</p>
      
      <br>
      <br>

      <input type="file" id="vid_upload" name="vid_upload" disabled=true />

      <br>
      <br>

      <label for="yt_source">YouTube video to search in:</label>
      <input type="text" id="yt_source" name="yt_source"/>

      <br>
      <br>

      <label for="flix_title">Name of Netflix show:</label>
      <input type="text" id="flix_title" name="flix_title" disabled=true/>

      <br>
      <br>

      <label for="flix_szn">Season #:</label>
      <input type="text" id="flix_szn" name="flix_szn" disabled=true/>

      <br>
      <br>

      <label for="flix_ep">Episode #:</label>
      <input type="text" id="flix_ep" name="flix_ep" disabled=true/>

      <br>
      <br>

      <input type="submit"/>
    </form>
    <p id="results"></p>
  </body>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script>
    //for hiding the labels
    var labels = document.getElementsByTagName('LABEL');
    for (var i = 0; i < labels.length; i++) {
        if (labels[i].htmlFor != '') {
             var elem = document.getElementById(labels[i].htmlFor);
             if (elem)
                elem.label = labels[i];         
        }
    }
    var searchSrc="yt"
    //yt = youtube (default)
    //flix = netflix
    //file = file
    function toggleFile(state){//state is "none" or "inline"
      document.getElementById("vid_upload").disabled = state;
    }
    function toggleYt(state){//state is "none" or "inline"
      document.getElementById("yt_source").disabled = state;
    }
    function toggleFlix(state){//state is "none" or "inline"
      document.getElementById("flix_title").disabled = state;
      document.getElementById("flix_szn").disabled = state;
      document.getElementById("flix_ep").disabled = state;
    }
    function ytSearch(){
      searchSrc="yt"
      toggleYt(false);
      toggleFlix(true);
      toggleFile(true);
    }
    function flixSearch(){
      searchSrc="flix"
      toggleYt(true);
      toggleFlix(false);
      toggleFile(true);
    }
    function fileSearch(){
      searchSrc="file"
      toggleYt(true);
      toggleFlix(true);
      toggleFile(false);
    }
    /**
     * JavaScript function to match (and return) the video Id 
     * of any valid Youtube Url, given as input string.
     * @author: Stephan Schmitz <eyecatchup@gmail.com>
     * @url: https://stackoverflow.com/a/10315969/624466
     */
    function ytVidId(url) {
      var p = /^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/;
      return (url.match(p)) ? RegExp.$1 : false;
    }
    function sendSearch(){
    var q = document.getElementById("quote").value;
      switch(searchSrc){
        case "yt":
          var id = ytVidId(document.getElementById("yt_source").value);
          if(id){
            $.ajax({
              type: 'POST',
              url: '/results?src='+ searchSrc + '&quote=' + q + '&source=' + id,
              success: function(data){
                document.getElementById('results').innerHTML = data;
              }
            })
          }else{document.getElementById('results').innerHTML = "ERROR: Invalid YouTube link";}
          break;

        case "flix":
          var title = document.getElementById("flix_title").value;
          var szn = document.getElementById("flix_szn").value;
          var ep = document.getElementById("flix_ep").value;
          $.ajax({
            type: 'POST',
            url: '/results?src='+ searchSrc + '&quote=' + q + '&title=' + title + '&szn=' + szn + '&ep=' + ep,
            success: function(data){
              document.getElementById('results').innerHTML = data;
            }
          })
          break;

        case "file":
          var form = document.getElementById('')
          $.ajax({
            type: 'POST',
            url: '/results?src='+ searchSrc + '&quote=' + q,
            success: function(data){
              document.getElementById('results').innerHTML = data;
            }
          })
          break;
        default:
          document.getElementById('results').innerHTML = "ERROR: Invalid source";
          break;
      }
    }
  </script>

</html>
