<html>
  <head>
    <link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='styles/style.css') }}">
    <link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='styles/results.css') }}">
  </head>
  <body>

    <div>
    <form action='/'>
      <button>New Search</button>
    </form>
    </div>

    <div id='spellchecking'>
        <p id="userQuery">Searched quote: {{query}}</p>
        <input type='text' id="inputQuote" style="display: none;" value="{{query}}">
        <button id = 'spellcheckButton' onclick='check_spelling()'>Check spelling</button>
    </div>

    <div>
    {% if result is not string %}
        {% for doc in result %}
            {% set id = doc['id'] %}
            {% set info = doc|tojson %}
            <div id="{{id}}" class="{{doc['type'] ~ ' result'}}">
                <div class="typetab"></div>
                {% if doc['type'] == 'yt' %}
                    <a class="title link" href='javascript:;' onclick='directToVideo({{info}}, "0")'>{{doc['title']}}</a>
                    <p class="info">{{doc['channel']}} • {{doc['date']}}</p>
                    <div id="wrap-timestamps">
                        <a class="thumbnail" href='javascript:;' onclick='directToVideo({{info}}, "0")'>
                            <img src="{{doc['thumb']}}" width=320 height=180 alt="thumbnail">
                        </a>
                        <div class="result-timestamps">
                        <table id="times" cellspacing="0px" cellpadding="0px">
                            {% for tuple in doc['list'] %}
                                {% set text = tuple[0] %}
                                {% set sec = tuple[1] %}
    
                                <tr onclick='directToVideo({{info}}, "{{loop.index0}}")'>
                                    <td>{{text}}</td>
                                    <td class="timestamp">{{time_string(sec)}}</td>
                                </tr>
    
                            {% endfor %}
                        </table>
                        </div>
                    </div>
                {% else %}
                    {% set extension, is_video = get_extension(id) %}
                    <a class="title link" href='javascript:;' onclick='directToVideo({{info}}, "0")'>{{id}}</a>
                    <p class="info">{{time_string(doc['length'])}} • {{extension.upper()}} File</p>
                    <div id="wrap-timestamps">
                        <a class="thumbnail" href='javascript:;' onclick='directToVideo({{info}}, "0")'>
                            {% if is_video %}
                            <video src="{{ url_for('download_file', filename=id) }}" width="320" height="180" alt="thumbnail" style="background-color: black;"></video>
                            {% else %}
                            <img src="static/images/audio.png" width=320 height=180 alt="thumbnail">
                            {% endif %}
                        </a>
                        <div class="result-timestamps">
                        <table id="times" cellspacing="0px" cellpadding="0px">
                            {% for tuple in doc['list'] %}
                                {% set text = tuple[0] %}
                                {% set sec = tuple[1] %}

                                <tr onclick='directToVideo({{info}}, "{{loop.index0}}")'>
                                    <td>{{text}}</td>
                                    <td class="timestamp">{{time_string(sec)}}</td>
                                </tr>

                            {% endfor %}
                        </table>
                        </div>
                    </div>
                {% endif %}
            </div>
        {% endfor %}
    {% else %}
        {{result}}
    {% endif %}
    </div>
    <script src="http://www.youtube.com/player_api"></script>
    <script>
        // This script needs to be here so the overlay can reference it
        var apiReady = false;
        function onYouTubeIframeAPIReady() {
            apiReady = true;
            console.log('api ready');
        }
    </script>
    <!-- THIS IS WHERE THE VIDEO OVERLAY WILL GO -->
  </body>

  <script src="https://unpkg.com/json5@^2.0.0/dist/index.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script type="text/javascript" src="{{url_for('static', filename='results.js')}}"></script>
</html>


